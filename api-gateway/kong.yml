_format_version: "2.1"
_transform: true

services:
  - name: auth-service
    url: http://auth-service:8001
    routes:
      - name: auth_health
        paths:
          - /health
        strip_path: false
        methods:
          - GET

      - name: auth_register
        paths:
          - /api/v1/auth/register
        strip_path: false
        methods:
          - POST

      - name: auth_login
        paths:
          - /api/v1/auth/login
        strip_path: false
        methods:
          - POST

      - name: auth_validate
        paths:
          - /api/v1/auth/validate
        strip_path: false
        methods:
          - POST
        plugins:
          - name: jwt

      - name: users_api
        paths:
          - /api/v1/users
        strip_path: false
        plugins:
          - name: jwt

  # - name: product-service
  #   url: http://product-service:8002
  #   routes:
  #     - name: products_get
  #       paths:
  #         - /api/v1/products
  #       strip_path: false
  #       methods:
  #         - GET
  #       plugins:
  #         - name: rate-limiting
  #           config:
  #             minute: 100
  #             policy: local

  #     - name: products_modify
  #       paths:
  #         - /api/v1/products
  #       strip_path: false
  #       methods:
  #         - POST
  #         - PUT
  #         - DELETE
  #       plugins:
  #         - name: jwt

  #     - name: inventory_api
  #       paths:
  #         - /api/v1/inventory
  #       strip_path: false
  #       plugins:
  #         - name: jwt

  #     - name: gold_price_api
  #       paths:
  #         - /api/v1/gold-price
  #       strip_path: false
  #       plugins:
  #         - name: jwt

plugins:
  - name: cors
    config:
      origins:
        - "*"
      methods:
        - GET
        - POST
        - PUT
        - DELETE
      headers:
        - Accept
        - Authorization
        - Content-Type
      exposed_headers:
        - "*"
      max_age: 3600
      credentials: true
